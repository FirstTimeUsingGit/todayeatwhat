<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>今晚食乜餸 - 智能晚餐食譜生成器</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        header {
            background: linear-gradient(90deg, #ff9a9e 0%, #fad0c4 100%);
            color: white;
            text-align: center;
            padding: 30px 20px;
        }
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }
        .main-content {
            padding: 30px;
        }
        .input-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }
        select, input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }
        .btn {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            transition: transform 0.2s;
            margin-bottom: 10px;
        }
        .btn:hover {
            transform: translateY(-2px);
        }
        .recipe-display {
            background: #f9f9f9;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }
        .recipe-title {
            font-size: 1.8em;
            color: #333;
            margin-bottom: 15px;
            text-align: center;
        }
        .recipe-steps {
            line-height: 1.8;
        }
        .recipe-steps ol {
            padding-left: 20px;
        }
        .recipe-steps li {
            margin-bottom: 10px;
        }
        .upload-area {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
        }
        .upload-area:hover {
            border-color: #667eea;
        }
        .image-preview {
            margin-top: 15px;
        }
        .image-preview img {
            max-width: 100%;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>今晚食乜餸</h1>
            <div class="subtitle">智能晚餐食譜生成器</div>
        </header>
        
        <div class="main-content">
            <div class="input-group">
                <label for="season">選擇季節：</label>
                <select id="season">
                    <option value="春季">春季</option>
                    <option value="夏季">夏季</option>
                    <option value="秋季">秋季</option>
                    <option value="冬季">冬季</option>
                </select>
            </div>
            
            <div class="input-group">
                <label for="ingredient">選擇現有材料：</label>
                <select id="ingredient" multiple size="5">
                    <option value="雞">雞胸肉</option>
                    <option value="豬">豬肉</option>
                    <option value="牛">牛肉</option>
                    <option value="魚">魚</option>
                    <option value="蝦">蝦</option>
                    <option value="蛋">雞蛋</option>
                    <option value="菜">青菜</option>
                    <option value="菇">菇類</option>
                    <option value="豆腐">豆腐</option>
                    <option value="米">米飯</option>
                    <option value="麵">麵條</option>
                    <option value="粉絲">粉絲</option>
                </select>
            </div>
            
            <div class="input-group">
                <label for="cuisine">選擇菜系：</label>
                <select id="cuisine">
                    <option value="中式">中式</option>
                    <option value="西式">西式</option>
                    <option value="日式">日式</option>
                    <option value="韓式">韓式</option>
                    <option value="泰式">泰式</option>
                    <option value="台式">台式</option>
                </select>
            </div>
            
            <div class="input-group">
                <label for="category">選擇菜式類別：</label>
                <select id="category">
                    <option value="主菜">主菜</option>
                    <option value="湯水">湯水</option>
                    <option value="甜品">甜品</option>
                    <option value="健康餐">健康餐</option>
                    <option value="重口味">重口味</option>
                </select>
            </div>
            
            <div class="input-group">
                <label for="uploadImage">上傳食材圖片：</label>
                <div class="upload-area" id="uploadArea" onclick="document.getElementById('uploadImage').click()">
                    點擊上傳食材圖片或拖拽圖片至此
                </div>
                <input type="file" id="uploadImage" accept="image/*" style="display: none;" onchange="previewImage(this)">
                <div class="image-preview" id="imagePreview"></div>
            </div>
            
            <div class="input-group">
                <button class="btn" onclick="editIngredients()">編輯材料</button>
                <button class="btn" onclick="editRecipes()">編輯食譜</button>
                <button class="btn" onclick="loadLatestRecipes()">載入最新食譜</button>
            </div>
            
            <button class="btn" onclick="generateRecipe()">生成食譜</button>
        </div>
        
        <div class="recipe-display" id="recipeDisplay">
            <div class="recipe-title" id="recipeTitle"></div>
            <div class="recipe-steps" id="recipeSteps"></div>
        </div>
    </div>

    <script>
        // 季節性材料推薦
        const seasonalIngredients = {
            '春季': ['筍', '韭菜', '菠菜', '豌豆苗', '小蔥', '香椿'],
            '夏季': ['冬瓜', '苦瓜', '絲瓜', '茄子', '空心菜', '豆角'],
            '秋季': ['南瓜', '蓮藕', '栗子', '白蘿蔔', '白菜', '柿子'],
            '冬季': ['白菜', '蘿蔔', '羊肉', '黑木耳', '銀耳', '桂圓']
        };

        // 更新材料選項根據季節
        document.getElementById('season').addEventListener('change', function() {
            const season = this.value;
            const ingredientSelect = document.getElementById('ingredient');
            const seasonalItems = seasonalIngredients[season] || [];
            
            // 清空現有選項（除了原有的）
            Array.from(ingredientSelect.options).forEach(option => {
                if (!['雞', '豬', '牛', '魚', '蝦', '蛋', '菜', '菇', '豆腐', '米', '麵', '粉絲'].includes(option.value)) {
                    option.remove();
                }
            });
            
            // 添加季節性材料
            seasonalItems.forEach(item => {
                const option = document.createElement('option');
                option.value = item;
                option.textContent = item;
                ingredientSelect.appendChild(option);
            });
        });

        // 圖片預覽功能
        function previewImage(input) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('imagePreview').innerHTML = '<img src="' + e.target.result + '" alt="食材圖片預覽">';
                }
                reader.readAsDataURL(file);
            }
        }

        // 模擬從icook抓取的食譜數據
        const icookRecipes = [];


        function loadLatestRecipes() {
            alert("已載入最新食譜數據！現在您可以選擇更多時令食譜。");
        }

        function generateRecipe() {
            const ingredients = Array.from(document.getElementById('ingredient').selectedOptions).map(option => option.value);
            const cuisine = document.getElementById('cuisine').value;
            const season = document.getElementById('season').value;
            const category = document.getElementById('category').value;
            
            // 根據條件篩選食譜
            let filteredRecipes = icookRecipes.filter(recipe => 
                (cuisine === recipe.cuisine || cuisine === '中式') &&
                (season === recipe.season || recipe.season === '四季') &&
                (category === recipe.category)
            );
            
            // 如果篩選後沒有食譜，則使用默認食譜
            if (filteredRecipes.length === 0) {
                filteredRecipes = [
                    {
                        name: `${season}${category} - ${ingredients[0]}料理`,
                        method: `1. 將${ingredients[0]}處理好備用\n2. 準備其他配料\n3. 按照${category}的做法進行烹調\n4. 調味後完成`
                    }
                ];
            }
            
            const recipeDisplay = document.getElementById('recipeDisplay');
            const recipeTitle = document.getElementById('recipeTitle');
            const recipeSteps = document.getElementById('recipeSteps');
            
            if (ingredients.length === 0) {
                alert('請選擇至少一種材料');
                return;
            }
            
            const selectedRecipe = filteredRecipes[Math.floor(Math.random() * filteredRecipes.length)];
            
            recipeTitle.textContent = selectedRecipe.name;
            recipeSteps.innerHTML = `<ol><li>${selectedRecipe.method.replace(/\n/g, '</li><li>')}</li></ol>`;
            
            recipeDisplay.style.display = 'block';
        }

        // 編輯材料功能
        function editIngredients() {
            const currentIngredients = Array.from(document.getElementById('ingredient').options).map(option => option.text);
            const newIngredient = prompt('請輸入新的材料名稱:', '');
            
            if(newIngredient) {
                const ingredientSelect = document.getElementById('ingredient');
                const option = document.createElement('option');
                option.value = newIngredient;
                option.textContent = newIngredient;
                
                // 檢查是否已存在相同的材料
                const existingOption = Array.from(ingredientSelect.options).find(opt => opt.value === newIngredient);
                if(!existingOption) {
                    ingredientSelect.appendChild(option);
                    alert(`已添加材料：${newIngredient}`);
                } else {
                    alert('該材料已存在！');
                }
            }
        }

        // 編輯食譜功能
        function editRecipes() {
            const cuisine = document.getElementById('cuisine').value;
            const category = document.getElementById('category').value;
            const ingredient = prompt('請輸入材料名稱以添加或修改食譜:', '');
            
            if(ingredient) {
                const recipeName = prompt('請輸入食譜名稱:', `${cuisine}${category}${ingredient}料理`);
                const recipe = prompt('請輸入食譜步驟 (每行一個步驟):', '');
                
                if(recipeName && recipe) {
                    alert(`已保存 ${recipeName}：\n${recipe}\n\n注意：此更改只在當前會話中有效，刷新頁面後會恢復預設食譜。`);
                    
                    // 添加到模擬數據中
                    icookRecipes.push({
                        id: icookRecipes.length + 1,
                        name: recipeName,
                        category: category,
                        ingredients: [ingredient],
                        method: recipe,
                        cuisine: cuisine,
                        season: document.getElementById('season').value
                    });
                }
            }
        }
    </script>
</body>
</html>